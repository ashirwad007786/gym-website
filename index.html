<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SkyLink Airways</title>
  <style>
    /* Base resets */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: Arial, sans-serif; background-color: #f9d2d2; color: #333; }
    button { cursor: pointer; }

    /* Splash screen */
    .splash-container {
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      height: 100vh; background-color: #f9d2d2;
      text-align: center;
    }
    .loader {
      border: 8px solid #f3f3f3;
      border-top: 8px solid #e85a4f;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      animation: spin 1s linear infinite;
      margin-bottom: 20px;
    }
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    .splash-container img { width: 150px; height: 150px; margin-bottom: 20px; }
    .splash-container h1 { font-size: 36px; color: #fff; margin-bottom: 20px; }

    /* Main containers */
    .container { max-width: 350px; margin: 40px auto; padding: 20px;
      background: #fff; border-radius: 30px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      text-align: center;
    }
    .container img { width: 150px; height: 150px; margin-bottom: 10px; }
    .container h2 { font-size: 28px; margin-bottom: 10px; }
    .container h3 { font-size: 20px; margin-bottom: 20px; }
    .container input, .container select {
      width: 100%; padding: 10px; margin: 10px 0;
      border: 1px solid #ccc; border-radius: 4px;
    }
    .container button {
      width: 100%; padding: 10px; margin: 10px 0;
      background: #e85a4f; border: none; color: white; border-radius: 4px;
      font-size: 16px;
    }

    /* Details view */
    .details {
      text-align: left; margin-top: 20px;
    }
    .details h4 { font-size: 20px; margin-bottom: 12px; }
    .details p { margin: 5px 0; }
  </style>
</head>
<body>
  <div id="toast" style="
  display: none;
  position: fixed;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%);
  background-color: #333;
  color: #fff;
  padding: 12px 24px;
  border-radius: 6px;
  font-size: 16px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.3);
  z-index: 9999;
  transition: opacity 0.3s ease;">
</div>
  
  <!-- Splash Screen -->
  <div id="splash" class="splash-container">
    <img src="images/airplane.png" alt="Airplane" />
    <h1>SkyLink Airways</h1>
    <div class="loader"></div>
  </div>

  <!-- Login Screen -->
  <div id="login" class="container" style="display:none;">
    <img src="images/airplane.png" alt="Airplane" />
    <h2>Welcome to</h2>
    <h3>SkyLink Airways</h3>
    <input type="text" id="username" placeholder="Username" />
    <input type="password" id="password" placeholder="Password" />
    <button id="loginBtn">Login</button>
  </div>

  <!-- Main Content -->
  <div id="main" class="container" style="display:none;">
    <input type="text" id="baggageInput" placeholder="Enter Baggage ID or Name" />
    <button id="fetchBtn">Fetch Details</button>

    <div id="details" class="details" style="display:none;">
      <h4>Luggage Details</h4>
      <p><b>Name:</b> <span id="luggageName"></span></p>
      <p><b>PNR:</b> <span id="luggagePnr"></span></p>
      <p><b>Weight:</b> <span id="luggageWeight"></span></p>
      <p><b>Last Location:</b> <span id="luggageLastLocation"></span></p>
      <p><b>Last Status:</b> <span id="luggageLastStatus"></span></p>
      <p><b>Source:</b> <span id="luggageSource"></span></p>
      <p><b>Destination:</b> <span id="luggageDestination"></span></p>


      <select id="locationSelect">
        <option value="">Select Location</option>
        <option>New Delhi</option>
        <option>Mumbai</option>
        <option>Ahmedabad</option>
        <option>Pune</option>
        <option>Surat</option>
        <option>Lucknow</option>
        <option>Amritsar</option>
        <option>Chandigarh</option>
        <option>Muscat</option>
        <option>Doha</option>
        <option>Bahrain</option>
        <option>Kabul</option>
        <option>Dubai</option>
      </select>
      <select id="statusSelect">
        <option value="">Select Status</option>
        <option value="Checked In">Checked In</option>
        <option value="Screened">Screened</option>
        <option value="Cleared for Loading">Cleared for Loading</option>
        <option value="Loaded on Aircraft">Loaded on Aircraft</option>
        <option value="In Transit">In Transit</option>
        <option value="Arrived at Transfer Airport">Arrived at Transfer Airport</option>
        <option value="Awaiting Transfer">Awaiting Transfer</option>
        <option value="Transferred to Connecting Flight">Transferred to Connecting Flight</option>
        <option value="Unloaded">Unloaded</option>
        <option value="At Customs">At Customs</option>
        <option value="Cleared Customs">Cleared Customs</option>
        <option value="Ready for Pickup">Ready for Pickup</option>
        <option value="Picked Up">Picked Up</option>
        <option value="Delayed">Delayed</option>
        <option value="Missing">Missing</option>
        <option value="Damaged">Damaged</option>
        <option value="Recheck Required">Recheck Required</option>
        <option value="Owner Notified">Owner Notified</option>
        <option value="Delivered to Owner">Delivered to Owner</option>
      </select>
      <button id="sendUpdateBtn">Create Tracking Record</button>
      <button id="clearBtn">Fetch Another</button>
    </div>
  </div>

  <script>
    // Config for your backend proxy (PHP endpoint)
    const API_URL = 'https://ascentracapital.com/salesforce.php';

    // UI elements
    const splash = document.getElementById('splash');
    const login = document.getElementById('login');
    const main = document.getElementById('main');
    const details = document.getElementById('details');
    const loginBtn = document.getElementById('loginBtn');
    const fetchBtn = document.getElementById('fetchBtn');
    const clearBtn = document.getElementById('clearBtn');
    const sendUpdateBtn = document.getElementById('sendUpdateBtn');

    let currentRecordId = '';

   
    // Splash -> Login
    setTimeout(() => {
      splash.style.display = 'none';
      login.style.display = 'block';
    }, 4000);

    // Login click: show main
    loginBtn.addEventListener('click', () => {
      const user = document.getElementById('username').value;
      const pass = document.getElementById('password').value;
      if (!user || !pass) return alert('Username and password required');
      login.style.display = 'none';
      main.style.display = 'block';
    });
function showToast(message, duration = 3000) {
  const toast = document.getElementById('toast');
  toast.textContent = message;
  toast.style.opacity = '1';
  toast.style.display = 'block';
  setTimeout(() => {
    toast.style.opacity = '0';
    setTimeout(() => toast.style.display = 'none', 300); // wait for fade out
  }, duration);
  details.style.display = 'none';
        document.getElementById('baggageInput').value = '';
        currentRecordId = '';
}
    // Fetch luggage details via your API proxy
    fetchBtn.addEventListener('click', async () => {
      const query = document.getElementById('baggageInput').value.trim();
      if (!query) return alert('Please enter a baggage ID or name');
      try {
        const resp = await fetch(`${API_URL}?name=${encodeURIComponent(query)}`);
        if (!resp.ok) throw new Error(`HTTP ${resp.status}`);
        const result = await resp.json();
        const data = result.records?.[0];
        if (!data) throw new Error('No BAGGAGE found');
        currentRecordId = data.Id || query;
        // populate UI
        details.style.display = 'block';
        //document.getElementById('luggageId').textContent = currentRecordId;
        document.getElementById('luggageName').textContent = data.Name;
        document.getElementById('luggagePnr').textContent = data.Booking__r?.Name || '';
        document.getElementById('luggageLastLocation').textContent = data.Location__c;
        document.getElementById('luggageLastStatus').textContent = data.Status__c;
        document.getElementById('luggageWeight').textContent = data.Baggage_Weight__c + ' kg';
        document.getElementById('luggageSource').textContent = data.Booking__r?.Flight__r?.Source_City__c  || '';
        document.getElementById('luggageDestination').textContent = data.Booking__r?.Flight__r?.Destination_City__c ;
      } catch (err) {
        alert(`Error fetching details: ${err.message}`);
      }
       
    });

    // Clear to fetch another
    clearBtn.addEventListener('click', () => {
      details.style.display = 'none';
      document.getElementById('baggageInput').value = '';
      currentRecordId = '';
    });

    // Create tracking record via API proxy
    sendUpdateBtn.addEventListener('click', async () => {
      const loc = document.getElementById('locationSelect').value;
      const status = document.getElementById('statusSelect').value;
      if (!loc) return alert('Please select a location');
      if (!currentRecordId) return alert('No baggage selected');
      const baggageName = document.getElementById('luggageName').textContent;
      const fullName = `${baggageName} - ${loc} (${status})`; 
      try {
        const payload = {
       object: 'Baggage_Tracking__c',
        Baggage__c: currentRecordId,
        Location__c: loc,
        Status__c: status,
        Name: fullName
        };
        console.log('Sending payload:', payload);
        const resp = await fetch(API_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });
        if (!resp.ok) throw new Error(`HTTP ${resp.status}`);
        const result = await resp.json();
        showToast("Tracking record created successfully!");
      } catch (err) {
        alert(`Error creating record: ${err.message}`);
      }
      
    });
  </script>
</body>
</html>
